<!DOCTYPE html>

<html lang="pt-br"><head>
<meta charset="utf-8"/>
<meta content="width=device-width,initial-scale=1" name="viewport"/>
<meta content="#7A2BFF" name="theme-color"/>
<link href="./img/favicon.svg" rel="icon" type="image/svg+xml"/>
<link href="./manifest.webmanifest" rel="manifest"/>
<meta content="#07070A" name="theme-color"/>
<link href="./styles.css" rel="stylesheet"/>
<title>Checkout • Conexão Street</title>
</head><body>
<div class="bg"></div><div class="noise"></div>
<div aria-hidden="true" class="loader" id="loader"><div style="display:flex;align-items:center;gap:12px"><div class="spin"></div><div><b>Carregando</b><br/><span class="sub" style="max-width:none;font-size:12px">Pagamento</span></div></div></div>
<div class="top">
<div class="wrap">
<div class="bar">
<a aria-label="Home" class="brand" href="./index.html">
<div class="logoBox"><img alt="Logo" src="./img/logo.svg"/></div>
<div>
<b>Conexão Street</b><br/>
<small>Pagamento</small>
</div>
</a>
<div class="pills">
<a class="pill muted" href="./products.html">Fornecedores</a>
<a class="pill muted" href="./produtos.html">Produtos</a>
<a class="pill muted" href="./admin.html" id="adminPill" style="display:none">Admin</a>
<a class="pill muted" href="./member.html">Área do membro</a>
<a class="pill" href="https://wa.me/5511919730067" rel="noopener" target="_blank">Suporte ↗</a>
</div>
</div>
</div>
</div>
<main class="wrap">
<div class="footer">© 2026 Conexão Street</div>
</main>
<div class="toast" id="toast"></div>
<script src="./config.js"></script>
<script src="https://cdn.jsdelivr.net/npm/@supabase/supabase-js@2"></script>
<script src="./js/ui.js"></script>

<script>
  // Guard: login obrigatório pra criar pedido (evita erro de RLS e melhora UX)
  (function(){
    function $(id){ return document.getElementById(id); }
    document.addEventListener("DOMContentLoaded", async function(){
      var btn = $("goPay");
      if(btn) btn.disabled = true;

      try{
        // CS vem de ./js/ui.js
        var u = await (window.CS && CS.user ? CS.user().catch(function(){return null;}) : Promise.resolve(null));
        if(!u || !u.id){
          try{ localStorage.setItem("cs_after_login", window.location.href); }catch(e){}
          if(window.CS && CS.toast) CS.toast("Você precisa entrar na sua conta para comprar.");
          // dá um tempinho pra pessoa ler
          setTimeout(function(){
            var url = new URL("member.html", window.location.href);
            window.location.href = url.toString();
          }, 650);
          return;
        }
      }catch(e){
        // se der erro, deixa seguir (não trava a página)
      }
      if(btn) btn.disabled = false;
    });
  })();
</script>
<script src="./js/checkout.js"></script>
</body></html>